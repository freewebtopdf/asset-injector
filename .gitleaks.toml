# Gitleaks configuration for Asset Injector Microservice
title = "Asset Injector Gitleaks Config"

[extend]
# Use the default gitleaks rules as a base
useDefault = true

[[rules]]
description = "AWS Access Key ID"
id = "aws-access-key-id"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS"]

[[rules]]
description = "AWS Secret Access Key"
id = "aws-secret-access-key"
regex = '''[A-Za-z0-9/+=]{40}'''
tags = ["key", "AWS"]

[[rules]]
description = "GitHub Personal Access Token"
id = "github-pat"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
description = "GitHub OAuth Access Token"
id = "github-oauth"
regex = '''gho_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
description = "GitHub App Token"
id = "github-app-token"
regex = '''(ghu|ghs)_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
description = "Generic API Key"
id = "generic-api-key"
regex = '''(?i)(api[_-]?key|apikey)['"]*\s*[:=]\s*['"][0-9a-zA-Z\-_]{16,}['"]'''
tags = ["key", "API"]

[[rules]]
description = "Generic Secret"
id = "generic-secret"
regex = '''(?i)(secret|password|passwd|pwd)['"]*\s*[:=]\s*['"][^'"\s]{8,}['"]'''
tags = ["secret"]

# Allowlist for test files and documentation
[allowlist]
description = "Allowlist for test files and documentation"
files = [
    '''.*_test\.go$''',
    '''.*\.md$''',
    '''.*\.txt$''',
    '''.*\.example$''',
]

# Allowlist for specific patterns that are not secrets
regexes = [
    '''example[_-]?key''',
    '''test[_-]?secret''',
    '''dummy[_-]?token''',
    '''placeholder''',
    '''your[_-]?key[_-]?here''',
]

# Allowlist for specific commits (if needed)
commits = []

# Allowlist for specific paths
paths = [
    '''.git/''',
    '''vendor/''',
    '''node_modules/''',
]